{"ast":null,"code":"var clientId='966170e49781462f9b0f4dff0b7fd5d7';var redirectUri='http://nasty-pot.surge.sh';var accessToken;var Spotify={getAccessToken:function getAccessToken(){if(accessToken){return accessToken;}// check for access token match\nvar accessTokenMatch=window.location.href.match(/access_token=([^&]*)/);var expiresInMatch=window.location.href.match(/expires_in=([^&]*)/);if(accessTokenMatch&&expiresInMatch){accessToken=accessTokenMatch[1];var expiresIn=Number(expiresInMatch[1]);//This clears the parameters, allowing us to grab a new access token when it expires\nwindow.setTimeout(function(){return accessToken='';},expiresIn*1000);window.history.pushState('Access Token',null,'/');return accessToken;}else{var accessUrl=\"https://accounts.spotify.com/authorize?client_id=\".concat(clientId,\"&response_type=token&scope=playlist-modify-public&redirect_uri=\").concat(redirectUri,\"\\n        \");window.location=accessUrl;}},search:function search(term){var accessToken=Spotify.getAccessToken();return fetch(\"https://api.spotify.com/v1/search?type=track&q=\".concat(term,\"\\n    \"),{headers:{Authorization:\"Bearer \".concat(accessToken)}}).then(function(response){return response.json();}).then(function(jsonResponse){if(!jsonResponse.tracks){return[];}return jsonResponse.tracks.items.map(function(track){return{id:track.id,name:track.name,artist:track.artist[0].name,album:track.album.name,uri:track.uri};});});},savePlaylist:function savePlaylist(name,trackUris){if(!name||!trackUris||trackUris.length===0)return;var userUrl='https://api.spotify.com/v1/me';var headers={Authorization:\"Bearer \".concat(accessToken)};var userId=undefined;var playlistId=undefined;fetch(userUrl,{headers:headers}).then(function(response){return response.json();}).then(function(jsonResponse){return userId=jsonResponse.id;}).then(function(){var createPlaylistUrl=\"https://api.spotify.com/v1/users/\".concat(userId,\"/playlists\");fetch(createPlaylistUrl,{method:'POST',headers:headers,body:JSON.stringify({name:name})}).then(function(response){return response.json();}).then(function(jsonResponse){return playlistId=jsonResponse.id;}).then(function(){var addPlaylistTracksUrl=\"https://api.spotify.com/v1/users/\".concat(userId,\"/playlists/\").concat(playlistId,\"/tracks\");fetch(addPlaylistTracksUrl,{method:'POST',headers:headers,body:JSON.stringify({uris:trackUris})});});});}};export default Spotify;","map":{"version":3,"names":["clientId","redirectUri","accessToken","Spotify","getAccessToken","accessTokenMatch","window","location","href","match","expiresInMatch","expiresIn","Number","setTimeout","history","pushState","accessUrl","search","term","fetch","headers","Authorization","then","response","json","jsonResponse","tracks","items","map","track","id","name","artist","album","uri","savePlaylist","trackUris","length","userUrl","userId","undefined","playlistId","createPlaylistUrl","method","body","JSON","stringify","addPlaylistTracksUrl","uris"],"sources":["C:/Users/Jayle/jamming/src/util/Spotify.js"],"sourcesContent":["const clientId = '966170e49781462f9b0f4dff0b7fd5d7';\r\nconst redirectUri = 'http://nasty-pot.surge.sh'\r\n\r\nlet accessToken;\r\n\r\nconst Spotify = {\r\n  getAccessToken() {\r\n    if (accessToken) {\r\n        return accessToken;\r\n    }\r\n\r\n    // check for access token match\r\n    const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\r\n    const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\r\n\r\n    if (accessTokenMatch && expiresInMatch) {\r\n        accessToken = accessTokenMatch[1];\r\n        const expiresIn = Number(expiresInMatch[1]);\r\n        //This clears the parameters, allowing us to grab a new access token when it expires\r\n        window.setTimeout(() => accessToken = '', expiresIn * 1000);\r\n        window.history.pushState('Access Token', null, '/');\r\n        return accessToken;\r\n    } else {\r\n        const accessUrl = `https://accounts.spotify.com/authorize?client_id=${clientId}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectUri}\r\n        `;\r\n        window.location = accessUrl;\r\n    }\r\n  },\r\n  search(term) {\r\n    const accessToken = Spotify.getAccessToken();\r\n    return fetch(`https://api.spotify.com/v1/search?type=track&q=${term}\r\n    `, { headers: {\r\n        Authorization: `Bearer ${accessToken}`\r\n    }\r\n}).then(response => {\r\n    return response.json();\r\n}).then(jsonResponse => {\r\n    if (!jsonResponse.tracks) {\r\n        return [];\r\n    }\r\n    return jsonResponse.tracks.items.map(track => ({\r\n        id: track.id,\r\n        name: track.name,\r\n        artist: track.artist[0].name,\r\n        album: track.album.name,\r\n        uri: track.uri\r\n    }));\r\n});\r\n  },\r\n\r\n  savePlaylist(name, trackUris) {\r\n    if (!name || !trackUris || trackUris.length === 0) return;\r\n    const userUrl = 'https://api.spotify.com/v1/me';\r\n    const headers = {\r\n      Authorization: `Bearer ${accessToken}`\r\n    };\r\n    let userId = undefined;\r\n    let playlistId = undefined;\r\n    fetch(userUrl, {\r\n      headers: headers \r\n    })\r\n    .then(response => response.json())\r\n    .then(jsonResponse => userId = jsonResponse.id)\r\n    .then(() => {\r\n      const createPlaylistUrl = `https://api.spotify.com/v1/users/${userId}/playlists`;\r\n      fetch(createPlaylistUrl, {\r\n          method: 'POST',\r\n          headers: headers,\r\n          body: JSON.stringify({\r\n            name: name\r\n          })\r\n        })\r\n        .then(response => response.json())\r\n        .then(jsonResponse => playlistId = jsonResponse.id)\r\n        .then(() => {\r\n          const addPlaylistTracksUrl = `https://api.spotify.com/v1/users/${userId}/playlists/${playlistId}/tracks`;\r\n          fetch(addPlaylistTracksUrl, {\r\n            method: 'POST',\r\n            headers: headers,\r\n            body: JSON.stringify({\r\n              uris: trackUris\r\n            })\r\n          });\r\n        })\r\n    })\r\n  }\r\n};\r\n\r\nexport default Spotify;"],"mappings":"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"},"metadata":{},"sourceType":"module"}